<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script src="https://kit.fontawesome.com/a14ae32021.js" crossorigin="anonymous"></script>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>إلى أميمة حبيبتي</title>

<style type="text/css">
@font-face {
    font-family: digit;
    src: url('digital-7_mono.ttf') format("truetype");
}
body {
    direction: rtl;
    text-align: center;
    font-family: 'Amiri', serif;
    margin: 0;
    padding: 0;
    background: #ffe;
    font-size: 12px;
    overflow: auto;
}
#mainDiv {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
}
#content {
    width: 90%;
    max-width: 1200px;
    margin: 20px auto;
    display: flex;
    flex-direction: column;
    align-items: center;
}
#loveHeart {
    width: 670px;
    height: 625px;
    margin: 0 auto 20px auto;
    display: flex;
    justify-content: center;
    align-items: center;
}
#garden {
    width: 100%;
    height: 100%;
}
#code {
    width: 90%;
    max-width: 800px;
    color: #333;
    font-family: 'Amiri', serif;
    font-size: 28px;
    line-height: 1.8;
    text-align: center;
    margin-top: 20px;
}
#code .string {
    color: #2a36ff;
}
#code .keyword {
    color: #7f0055;
    font-weight: bold;
}
#code .placeholder {
    margin-left: 15px;
}
#code .space {
    margin-left: 7px;
}
#code .comments {
    color: #3f7f5f;
}
#words {
    font-family: 'Amiri', serif;
    width: 500px;
    font-size: 24px;
    color: #666;
}
#messages {
    display: none;
    text-align: center;
    font-size: 30px;
}
#elapseClock {
    text-align: center;
    font-size: 18px;
    margin-top: 10px;
    margin-bottom: 10px;
}
#elapseClock .digit {
    font-family: "digit";
    font-size: 40px;
    text-align: center;
}
#loveu {
    padding: 5px;
    font-size: 35px;
    margin-top: 80px;
    margin-right: 120px;
    text-align: right;
    display: none;
}
#loveu .signature {
    margin-top: 10px;
    font-size: 22px;
    font-style: italic;
    margin-right: 2em;
}
#clickSound {
    display: none;
}
#backgroundAudio {
    display: none;
}
#copyright {
    margin-top: 10px;
    text-align: center;
    width: 100%;
    color: #666;
}
#errorMsg {
    width: 100%;
    text-align: center;
    font-size: 24px;
    position: absolute;
    top: 100px;
    left: 0;
}
#copyright a {
    color: #666;
}
#icon {
    font-size: 48px;
    color: red;
}
#heartspan {
    display: block;
    text-align: center;
    margin: 20px 0;
}
</style>
<link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet">
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/garden.js"></script>
<script type="text/javascript" src="js/functions.js"></script>
</head>

<body>
<div id="mainDiv">
    <div id="content">
        <div id="loveHeart">
            <canvas id="garden"></canvas>
            <div id="words">
                <div id="messages">
                    مع أميمة
                    <div id="elapseClock"></div>
                </div>
                <div id="loveu">
                    أحبكِ بكل قلبي<br/>
                    <div class="signature">المهندس  </div>
                </div>
            </div>
        </div>
        <div id="code">
            يا أميمة، يا نور قلبي وبهجة روحي،<br />
            أنتِ الزهرة التي أنارت حدائق حياتي، والنجمة التي تزين سماء أحلامي. منذ أكثر من خمسة أشهر، ونحن ننسج معًا قصة حب لا تُضاهى، بدأت بكلمات عبر الشاشات وتحولت إلى لحظات لا تُنسى. لقاؤنا الأول كان كالحلم، لحظة توقف فيها الزمن، وشعرت أن قلبي وجد موطنه بين يديكِ. تلك اللحظات التي قضيناها معًا، مليئة بالحب والضحكات، محفورة في قلبي إلى الأبد.<br />
            كل رسالة منكِ هي شرارة تضيء يومي، وكل همسة منكِ هي اللحن الذي يرافق أحلامي. أتذكر عينيكِ اللامعتين وابتسامتكِ التي أذابت قلبي في لقائنا، وأتوق للمزيد من تلك اللحظات التي تجمعنا. حبكِ، يا أميمة، هو الوقود الذي يدفعني لأكون أفضل، لأحلم بمستقبل نعيشه معًا، مليء بالحب والسعادة.<br />
            أعدكِ بأن أكون لكِ الحبيب الذي يملأ قلبكِ بالفرح، والصديق الذي يستمع إليكِ في كل لحظة، والسند الذي يقف إلى جانبكِ مهما كانت التحديات. أنتظر بفارغ الصبر لقاءاتنا القادمة، لنصنع المزيد من الذكريات التي ستظل خالدة. أنتِ، يا أميمة، الضوء الذي ينير دربي، والحب الذي يملأ قلبي.<br />
            أحبكِ بكل ما أملك من مشاعر، وأشكر الله أن جمعني بكِ. سأظل أحبكِ وأحميكِ وأعيش لأجلكِ، يا زهرة قلبي.<br />
            

        </div>
    </div>
    <div id="backgroundAudio">
        <audio id="bgMusic" autoplay loop muted>
            <source src="sounds/sound.mp3" type="audio/mpeg">
            <source src="sounds/sound.wav" type="audio/wav">
            متصفحك لا يدعم تشغيل الصوت.
        </audio>
    </div>
</div>

<script type="text/javascript">
var offsetX = $("#loveHeart").width() / 2;
var offsetY = $("#loveHeart").height() / 2 - 55;
var together = new Date();
together.setFullYear(2025, 3, 23); // Adjusted to reflect ~5 months before August 26, 2025
together.setHours(16);
together.setMinutes(30);
together.setSeconds(0);
together.setMilliseconds(0);

if (!document.createElement('canvas').getContext) {
    var msg = document.createElement("div");
    msg.id = "errorMsg";
    msg.innerHTML = "متصفحك لا يدعم HTML5!<br/>نوصي باستخدام Chrome 14+/IE 9+/Firefox 7+/Safari 4+"; 
    document.body.appendChild(msg);
    $("#code").css("display", "none");
    $("#copyright").css("position", "absolute");
    $("#copyright").css("bottom", "10px");
    document.execCommand("stop");
} else {
    setTimeout(function () {
        startHeartAnimation();
    }, 5000);

    timeElapse(together);
    setInterval(function () {
        timeElapse(together);
    }, 500);

    adjustCodePosition();
    $("#code").typewriter();

    // Handle audio autoplay
    var audio = document.getElementById("bgMusic");
    audio.currentTime = 8; // Start audio at 8 seconds
    audio.volume = 0.5; // Set volume for audibility
    console.log("Attempting to play audio on page load...");

    // Function to attempt audio playback
    function tryPlayAudio() {
        var playPromise = audio.play();
        if (playPromise !== undefined) {
            playPromise
                .then(function() {
                    console.log("Audio is playing successfully.");
                    // Unmute after a short delay
                    setTimeout(function() {
                        audio.muted = false;
                        console.log("Audio unmuted after delay.");
                    }, 500);
                })
                .catch(function(error) {
                    console.log("Autoplay failed: ", error);
                    // Fallback: Play and unmute on user interaction
                    document.addEventListener('click', function playAudioOnInteraction() {
                        console.log("Attempting to play audio on user click...");
                        audio.currentTime = 8; // Ensure start at 8 seconds
                        audio.muted = false;
                        audio.play().then(function() {
                            console.log("Audio played on click.");
                        }).catch(function(err) {
                            console.log("Error playing audio on click: ", err);
                        });
                        document.removeEventListener('click', playAudioOnInteraction);
                    }, { once: true });
                });
        }
    }

    // Try playing audio when DOM is fully loaded
    document.addEventListener('DOMContentLoaded', function() {
        console.log("DOM fully loaded, attempting audio playback...");
        tryPlayAudio();
    });

    // Additional attempt after a short delay
    setTimeout(function() {
        console.log("Retrying audio playback after delay...");
        tryPlayAudio();
    }, 1000);
}
</script>
</body>
</html>
